# Требования ко всей системе (System Requirements)

## 1. Цель системы

Система «MAD Application» — мобильное приложение (iOS, SwiftUI) и связанная серверная часть (API + сервисы качества), которые позволяют пользователю выполнять ключевые сценарии продукта X, а команде — контролировать качество (надежность, производительность, безопасность, UX) и непрерывно улучшать продукт на основе измеримых метрик и обратной связи.

## 2. Область применения и границы

### Входит в систему

- Мобильный клиент iOS (SwiftUI) — основной пользовательский интерфейс.
- Backend API — хранение/синхронизация данных, аутентификация, бизнес‑операции.
- Сервисы качества (observability): мониторинг, сбор логов/трейсов, алерты.
- Сервис обратной связи (CSI/NPS, тикеты/сообщения).
- Аналитика продуктовых событий (ретеншн, конверсия, время сессии).

### Не входит (но учитывается как интеграции)

- Магазины приложений (App Store Connect), MDM.
- Email/SMS‑провайдеры (если используются).
- Сторонние платежи/реклама (если будут — отдельное расширение требований).

## 3. Стейкхолдеры

- Пользователь (конечный клиент): хочет быстро и понятно решать задачу продукта X.
- Команда разработки: хочет стабильную архитектуру, тестируемость, наблюдаемость.
- Преподаватель/оценщик: проверяет полноту требований и зрелость quality‑подхода.

## 4. Основные пользовательские сценарии (уровень системы)

> Подставь доменные сущности: «объект», «задача», «заявка», «заметка» и т.п.

- UC‑01: Онбординг/первый запуск — пользователь понимает ценность и начинает работу.
- UC‑02: Регистрация/вход — безопасная аутентификация, восстановление доступа.
- UC‑03: Просмотр списка объектов — фильтр/поиск/сортировка.
- UC‑04: Просмотр деталей объекта — полная информация + действия.
- UC‑05: Создание/редактирование/удаление объекта (CRUD) — валидируется и синхронизируется.
- UC‑06: Работа при плохой сети — кэш, ретраи, понятные сообщения об ошибках.
- UC‑07: Обратная связь — пользователь оставляет CSI/NPS или сообщение о проблеме.

## 5. Функциональные требования (FR) — уровень системы

### FR‑Auth (аутентификация/сессии)

- FR‑Auth‑1: Система должна поддерживать вход пользователя (email/пароль или SSO — выбрать).
- FR‑Auth‑2: Система должна поддерживать выход и отзыв сессии на сервере.
- FR‑Auth‑3: Система должна хранить токены доступа в безопасном хранилище (iOS Keychain).

### FR‑Data (данные и синхронизация)

- FR‑Data‑1: Система должна предоставлять API для получения списка объектов и детали объекта.
- FR‑Data‑2: Система должна поддерживать создание/обновление/удаление объекта.
- FR‑Data‑3: Клиент должен кэшировать последний успешный результат и показывать его оффлайн (с маркировкой «возможна неактуальность»).
- FR‑Data‑4: Клиент должен выполнять повторные попытки запросов при временных сбоях (с backoff).

### FR‑UX (UX/помощь)

- FR‑UX‑1: Система должна предоставлять онбординг и подсказки к ключевым сценариям.
- FR‑UX‑2: Сообщения об ошибках должны быть понятными и предлагать действие (повторить/проверить сеть/обратиться в поддержку).

### FR‑Feedback (обратная связь)

- FR‑Feedback‑1: Клиент должен содержать кнопку «Обратная связь».
- FR‑Feedback‑2: Клиент должен показывать периодический запрос оценки (CSI/NPS) после завершения ключевого сценария (не чаще N раз за период).
- FR‑Feedback‑3: Система должна сохранять ответы пользователя и связывать их с версией приложения/устройством/сессией (с учетом privacy).

### FR‑Observability (наблюдаемость качества)

- FR‑Obs‑1: Система должна собирать crash‑events клиента и серверные ошибки.
- FR‑Obs‑2: Система должна собирать метрики latency/error‑rate по API и визуализировать их.
- FR‑Obs‑3: Система должна поддерживать алерты при деградации (рост error‑rate, рост latency, падение crash‑free).

## 6. Нефункциональные требования (NFR) — уровень системы

### NFR‑Usability (юзабилити)

- NFR‑U‑1: Ключевой сценарий UC‑03 → UC‑04 должен выполняться за ≤ 3 тапа.
- NFR‑U‑2: Ошибка сети должна быть объяснена без технических терминов и с CTA.
- NFR‑U‑3: Приложение должно поддерживать Dynamic Type и VoiceOver для основных экранов.

### NFR‑Performance (производительность)

- NFR‑P‑1: Холодный старт (cold start) должен быть измеряем и улучшаться; целевое значение фиксируется как KPI (см. `src/docs/metrics_monitoring_feedback.md`).
- NFR‑P‑2: Время загрузки списка объектов (UC‑03) при 4G должно быть в пределах целевого SLA.
- NFR‑P‑3: Расход трафика при обновлении списка должен быть ограничен (постраничность/диффы/кэш‑заголовки).

### NFR‑Reliability (надежность)

- NFR‑R‑1: Система должна корректно переживать переключения background/foreground без потери данных.
- NFR‑R‑2: При временной недоступности backend клиент должен деградировать «мягко» (кэш/повтор/пояснение).
- NFR‑R‑3: Должна быть определена ключевая метрика надежности и инструмент мониторинга (см. QAP).

### NFR‑Security & Privacy (безопасность и приватность)

- NFR‑S‑1: Все сетевые вызовы должны использовать TLS; запрет на небезопасные протоколы.
- NFR‑S‑2: Секреты и токены не должны попадать в логи.
- NFR‑S‑3: Данные «в покое» на устройстве должны быть защищены (Keychain + защита локального хранилища).
- NFR‑S‑4: Система должна собирать только необходимые данные (data minimization) и информировать пользователя.

### NFR‑Compatibility (совместимость)

- NFR‑C‑1: Поддерживаемые версии iOS фиксируются в требованиях (минимум iOS N).
- NFR‑C‑2: Должна быть матрица устройств для проверки (минимум 2 размера экрана).

## 7. Ограничения и допущения

- Мобильный клиент реализуется на SwiftUI (база: `src/app/mad_application`).
- Backend может быть реализован как монолитный API или набор микросервисов; для «2 балла» описывается сетевой ландшафт и связность сервисов.
- В dev/учебном режиме допускается использование сторонних сервисов (Sentry/Crashlytics) вместо self-hosted.

## 8. Критерии приемки (Definition of Done для QAP)

Минимум (полнота / «1 балл»):

- Есть описанная модель качества и чек‑лист.
- Есть диаграмма функциональности и список сценариев.
- Приложение запускается в IDE и на устройстве (требование QAP “installed & running”).
- Есть способ дать обратную связь (кнопка).

Максимум («2 балла»):

- Есть top‑level архитектурная диаграмма + сетевая связность сервисов/микросервисов.
- Есть модель тестирования с автоматизацией UI и performance‑тестом, а также планом load‑тестирования (по возможности — для backend).
- Есть выбранная ключевая метрика надежности + инструмент мониторинга (Prometheus/Grafana/Zabbix и/или crash monitoring).
- Есть механизм периодического CSI/NPS prompt после завершения сценария.

